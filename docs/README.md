# Базовая часть индивидуального отчёта по проектной практике

---

## 1. Настройка Git и репозитория

- Для ведения проектной деятельности я использовал личный репозиторий на GitHub.
- Изучение git-команд, создание репозитория, настройка remotes и push/pull были выполнены ранее в рамках учебного процесса.
- В процессе работы над проектом использовались только базовые функции Git — инициализация репозитория, клонирование, добавление и коммиты изменений, push в удалённый репозиторий.
- Основная работа велась в одной ветке (`master`). Ветки для фич или пулл-реквесты не создавались, так как проект индивидуальный.
- Время: ~5 часов.

---

## 2. Написание документов в Markdown

- Основной опыт работы с Markdown в рамках базовой части заключался в оформлении сайта-портфолио проекта (см. пункт 3) и сопутствующей проектной документации (описания, ресурсы, журнал).
- Специально синтаксис Markdown не изучал, использовал базовые элементы: заголовки, списки, ссылки, выделение кода и вставку картинок.
- Для форматирования технической документации и описания разделов сайта использовал стандартные возможности Markdown в Hugo.
- Отдельных методичек или мануалов по Markdown не создавал.
- Время: ~5 часов.

---

## 3. Создание статического веб-сайта

- Для создания сайта проекта использовал генератор Hugo с темой [PaperMod](https://github.com/adityatelange/hugo-PaperMod).
- Проект был развернут локально, затем задеплоен на GitHub Pages.
- Сайт полностью посвящён теме "ODC — открытый протокол цифровых наличных" (Open Digital Cash), не совпадает по содержанию с вариативной частью (сайт уникальный).
- Структура сайта включает:
    - Домашнюю страницу с аннотацией (что такое ODC, цели проекта, ключевые особенности).
    - Страницу "О проекте" с подробным описанием протокола, его истории и текущего состояния.
    - Страницу "Журнал" с тремя отдельными постами о ходе работ/разработке (например: "Начало проекта", "Добавлены схемы протокола", "Рефакторинг документации").
    - Страницу "Участники", где отражён мой личный вклад в проект (так как работал один).
    - Страницу "Ресурсы" с подборкой ссылок на официальные репозитории ODC, используемые технологии (FastAPI, Hugo, Mermaid.js и др.), а также лицензионную информацию.
- Для оформления использованы графические материалы: схемы протокола, диаграммы (генерировались в Mermaid.js).
- Сайт полностью работоспособен, вёрстка и структура отлажены.
- Время: настройка и изучение Hugo — 10 часов, дизайн и наполнение сайта — 5 часов.

---

## 4. Взаимодействие с организацией-партнёром

- В рамках базовой части я принял участие в онлайн-конференции R-Vision, посвящённой современным тенденциям в IT и информационной безопасности.
- Опыт взаимодействия был больше ознакомительный: основное внимание уделялось историям из практики, примерам из корпоративного IT.
- Прямого влияния на мой проект посещение мероприятия не оказало, однако позволило ознакомиться с текущей повесткой в отрасли и актуальными задачами по цифровой безопасности.
- По итогам был написан краткий отчёт о прослушанном мероприятии и выводах для себя.
- Время: 4 часа на участие

---

## 5. Отчёт по практике

- По шаблону из папки `reports` был составлен и оформлен индивидуальный отчёт по учебной практике.
- Итоговые файлы "report.docx" и "report.pdf" размещены в папке `/reports` в репозитории.
- Оба варианта (docx и pdf) были также загружены в СДО для сдачи.
- Отчёт составлен по предоставленной структуре, с отражением этапов выполнения базовой и вариативной части.

| Этап                                   | Время (часы) |
|----------------------------------------|:------------------------------------:|
| 1. Работа с Git и репозиторием         |                 5                   |
| 2. Оформление документов в Markdown    |                 5                   |
| 3. Изучение Hugo и настройка сайта     |                10                   |
| 4. Дизайн и наполнение контентом       |                 5                   |
| 5. Дополнительная отладка и публикация |                 3                   |
| 6. Взаимодействие с партнёром          |                 4                   |
| 7. Оформление и сдача итогового отчёта |                 4                   |
| **Итого**                             |               **36**                |


# Мини-библиотека XLSX на Swift

## Краткое описание

**Проект:** Самостоятельная реализация с нуля собственной мини-библиотеки для чтения и записи файлов формата XLSX (Excel) на языке Swift.  
**Цель:** Разобраться в структуре XLSX и принципах OpenXML на практике, написать свой минимальный рабочий аналог экспорта/импорта Excel-таблиц без сторонних библиотек.

---

## Хронология и этапы работы (всего ~40 часов)

### 1. Изучение предметной области, постановка задачи, исследование стандарта (7 часов)

- Анализ устройства формата XLSX (структура zip-архива, основные XML-файлы, как устроены workbook.xml, sharedStrings.xml, отдельные листы).
- Чтение спецификаций OpenXML и разбор реальных файлов Excel через архиватор и Notepad++.
- Планирование структуры кода: определил сущности (Workbook, Sheet, Cell, Style), расписывал, как маппить XML-элементы в объекты Swift.
- Чтение чужих решений, примеров кода на Swift и других языках (с GitHub), формирование минимально необходимого функционала.

---

### 2. Проектирование и написание базовых структур данных (5 часов)

- Реализация enum для типа ячеек (CellType), структуры Cell, хранения таблицы ячеек в Sheet.
- Базовые функции для чтения и записи значений в ячейки.
- Придумывал и реализовывал конвертацию адреса ячейки ("A1", "B2") в индексы, обработку граничных случаев.

---

### 3. Парсинг и генерация XML для workbook/sheet/sharedStrings (8 часов)

- Изучение структуры XML для листов и рабочей книги, исследование стандартных XML-атрибутов.
- Реализация классов XLSXReader/XLSXWriter:
  - Чтение workbook.xml — определение имен и id листов.
  - Парсинг sharedStrings.xml для работы с текстовыми ячейками.
  - Парсинг sheetX.xml: чтение всех вариантов ячеек (text, bool, number, inlineStr).
  - Генерация аналогичных XML при записи.
- Тесты на чтение/запись самых простых таблиц.

---

### 4. Работа со слияниями ячеек, реализация merged cells (4 часа)

- Разбор как Excel хранит слияния ячеек (mergeCells, mergeCell в XML).
- Реализация функций merge/unmerge ячеек в Sheet.
- Проверка обработки слияния при чтении и записи (перечитывание корневой ячейки, корректное сохранение диапазонов).
- Исправление багов при попытках чтения/записи в объединённые ячейки.

---

### 5. Поддержка стилей ячеек (4 часа)

- Изучение структуры styles.xml, определение какие параметры реально поддержать (шрифт, цвет, выравнивание).
- Описание и реализация структур Style, Font, Fill, Color, Horizontal/VerticalAlignment.
- Реализация связи между ячейкой и стилем (cellsStyleMap).
- В тестах проверял, что стили хотя бы минимально переносятся между Excel и библиотекой.

---

### 6. Отладка, багфиксы, работа с краевыми кейсами (9 часов)

- Многочасовая работа с реальными файлами Excel: пробовал сохранять и читать разные варианты таблиц, ловил edge cases.
- Исправлял баги с некорректной записью/чтением XML (особенно inlineStr и sharedStrings).
- Много раз пересобирал библиотеку после выявления очередных несовместимостей (порядок строк, пустые ячейки, merge за границами, стили не применяются).
- Добавил логирование, разбирался с ошибками ZIPFoundation.
- Проверял работу на файлах, созданных не только в Excel, но и в Google Sheets, Numbers (совместимость).

---

### 7. Оформление технической и пользовательской документации (развёрнуто, 1 час)

- Подробно расписал README.md для проекта:
  - Описание архитектуры (кратко о классах и связях).
  - Инструкции для начинающих — как пользоваться библиотекой (создание Workbook, добавление листов, запись/чтение ячеек, стили, merge).
  - Вставил примеры кода для каждого сценария.
  - Визуализировал архитектуру с помощью PlantUML (диаграммы классов), добавил схемы (структура XLSX, процесс чтения/записи).
  - Приложил куски XML, которые генерирует библиотека, и пояснения к ним.
  - Вставил таблицы с описанием параметров функций, описание граничных кейсов (merge, стили, пустые строки).
  - Описал отличия от настоящего Excel (ограничения и поддерживаемые возможности).

---

## Общая таблица временных затрат

| Этап                       | Примерное время (часы) |
|----------------------------|------------------------|
| Изучение XLSX, OpenXML     | 7                      |
| Проектирование структур    | 5                      |
| Парсинг/генерация XML      | 8                      |
| Реализация merge           | 4                      |
| Реализация стилей          | 4                      |
| Отладка и багфиксы         | 9                      |
| Документирование           | 1                      |
| **Итого**                  | **38**                 |


---



### Пример: создание книги, добавление листа и запись ячеек

```swift
let workbook = Workbook()
workbook.addSheet(name: "Sheet1", id: 1)
workbook["Sheet1", "A1"] = .text("Привет, XLSX!")
workbook["Sheet1", "B1"] = .number(42)
